%!PS-Adobe-3.0

/wd 3.0 72 mul def % 216
/ht 4.0 72 mul def % 288 
<</PageSize [wd ht]>> setpagedevice  
/pct { 0.01  mul  mul  } def
/Helvetica 8 selectfont

% obj -> show it
% show only works with strings
/show-it {
  % COMMON IDIOM: a temporary dict
  1 dict begin % temp dict!
    /sbuff 20 string def % string buffer for cvs
    sbuff cvs % convert arg into a string
    show
  end  % pop the temp dict off the dict-stack
} def

% dict x y -> print the data-dict key-value pairs
% example input:
%  <<(name)(Annapurna) (height)8030 (country)(Nepal)>> 100 200
/oh-mighty-mountain {
  moveto % eats the x y on the stack
  { % puts each key-value pair the operand stack
    % WARNING: iteration order is not specified for a dict!
    % WARNING: (height) coerced by PS into /height!
    % /height 8030
    % swap the two top items on the stack
    exch %  8030 /height  
    
    % cvs converts objects to strings
    show-it % 8030 
    
    (:) show % 8030 
    show-it
    
    ( ) show % spacing
  } forall % iterate over all key-value pairs
} def

% array x y -> print the array items
% example input:
%  [(Mercury) (Venus) (Earth) (Mars)] 100 200
/oh-glorious-planets {
  moveto % eats the x y on the stack
  { % puts each array-item on the stack in sequence
    show
    ( ) show % spacing
  } forall
} def

% THIS IS AN IMPORTANT PATTERN: procs defined first, then pass 
% a data structure to the proc (in practice, usually a dict).
%
% PROLOG: the procs at the top (hand-crafted!).
% SCRIPT: the part where a data structure is passed to 
% the procs (generated by a program!).

<<(name)(Annapurna) (height)8091 (country)(Nepal)>>
wd 5 pct  ht 90 pct
oh-mighty-mountain

[(Mercury) (Venus) (Earth) (Mars)] 
wd 5 pct  ht 80 pct
oh-glorious-planets

showpage